<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.Font?>

<VBox xmlns="http://javafx.com/javafx" 
      xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.bibliotheque.controller.LivreController"
      spacing="15"
      style="-fx-background-color: linear-gradient(to bottom, #f8f9fa, #e9ecef); -fx-padding: 20;">
    
    <!-- ========== EN-TÃŠTE ========== -->
    <HBox spacing="20" alignment="CENTER_LEFT">
        <Label text="ðŸ“š" style="-fx-font-size: 36px;"/>
        <VBox spacing="5">
            <Label text="Gestion des Livres" 
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
            <Label text="GÃ©rez votre collection de livres" 
                   style="-fx-font-size: 14px; -fx-text-fill: #7f8c8d;"/>
        </VBox>
        <Region HBox.hgrow="ALWAYS"/>
    </HBox>
    
    <!-- ========== BARRE DE RECHERCHE ========== -->
    <VBox spacing="10" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 10;">
        <Label text="ðŸ” Recherche rapide" style="-fx-font-weight: bold; -fx-font-size: 16px;"/>
        
        <HBox spacing="10" alignment="CENTER_LEFT">
            <TextField fx:id="txtRecherche" 
                       promptText="Tapez un titre, auteur, ISBN ou catÃ©gorie..."
                       HBox.hgrow="ALWAYS"
                       style="-fx-pref-height: 40px; -fx-font-size: 14px;"/>
            
            <Button fx:id="btnRechercher" text="Rechercher" 
                    style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; 
                           -fx-pref-height: 40px; -fx-pref-width: 120px;"/>
            
            <Button fx:id="btnRechercheAvancee" text="Recherche avancÃ©e" 
                    style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-weight: bold;
                           -fx-pref-height: 40px;"/>
        </HBox>
        
        <!-- Filtres rapides -->
        <HBox spacing="10">
            <Button text="ðŸ“– Tous les livres" 
                    onAction="#chargerLivres"
                    style="-fx-background-color: #2ecc71; -fx-text-fill: white;"/>
            <Button text="âœ… Disponibles" 
                    onAction="#filtrerDisponibles"
                    style="-fx-background-color: #27ae60; -fx-text-fill: white;"/>
            <Button text="âŒ EmpruntÃ©s" 
                    onAction="#filtrerEmpruntes"
                    style="-fx-background-color: #e74c3c; -fx-text-fill: white;"/>
            <Button text="â­ NouveautÃ©s" 
                    onAction="#filtrerNouveautes"
                    style="-fx-background-color: #f39c12; -fx-text-fill: white;"/>
        </HBox>
    </VBox>
    
    <!-- ========== STATISTIQUES ========== -->
    <HBox spacing="20" alignment="CENTER">
        <VBox alignment="CENTER" spacing="5" 
              style="-fx-background-color: #3498db; -fx-background-radius: 8; -fx-padding: 10; -fx-pref-width: 120;">
            <Label text="ðŸ“Š" style="-fx-font-size: 24px;"/>
            <Label fx:id="lblTotalLivres" text="0" 
                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: white;"/>
            <Label text="Livres" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
        </VBox>
        
        <VBox alignment="CENTER" spacing="5" 
              style="-fx-background-color: #2ecc71; -fx-background-radius: 8; -fx-padding: 10; -fx-pref-width: 120;">
            <Label text="âœ…" style="-fx-font-size: 24px;"/>
            <Label fx:id="lblLivresDisponibles" text="0" 
                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: white;"/>
            <Label text="Disponibles" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
        </VBox>
        
        <VBox alignment="CENTER" spacing="5" 
              style="-fx-background-color: #e74c3c; -fx-background-radius: 8; -fx-padding: 10; -fx-pref-width: 120;">
            <Label text="ðŸ“š" style="-fx-font-size: 24px;"/>
            <Label fx:id="lblLivresEmpruntes" text="0" 
                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: white;"/>
            <Label text="EmpruntÃ©s" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
        </VBox>
        
        <VBox alignment="CENTER" spacing="5" 
              style="-fx-background-color: #9b59b6; -fx-background-radius: 8; -fx-padding: 10; -fx-pref-width: 120;">
            <Label text="ðŸ“ˆ" style="-fx-font-size: 24px;"/>
            <Label fx:id="lblTauxDisponibilite" text="0%" 
                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: white;"/>
            <Label text="DisponibilitÃ©" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
        </VBox>
    </HBox>
    
    <!-- ========== BARRE D'OUTILS ========== -->
    <HBox spacing="10" alignment="CENTER_LEFT">
        <Label text="Actions :" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
        
        <Button fx:id="btnAjouter" text="âž• Ajouter un livre" 
                onAction="#ajouterLivre"
                style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold;
                       -fx-pref-height: 40px;"/>
        
        <Button fx:id="btnModifier" text="âœï¸ Modifier" 
                onAction="#modifierLivre" disable="true"
                style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-weight: bold;
                       -fx-pref-height: 40px;"/>
        
        <Button fx:id="btnSupprimer" text="ðŸ—‘ï¸ Supprimer" 
                onAction="#supprimerLivre" disable="true"
                style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-weight: bold;
                       -fx-pref-height: 40px;"/>
        
        <Button fx:id="btnVoirDetails" text="ðŸ‘ï¸ Voir dÃ©tails" 
                onAction="#voirDetails" disable="true"
                style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold;
                       -fx-pref-height: 40px;"/>
        
        <Region HBox.hgrow="ALWAYS"/>
        
        <Button fx:id="btnRafraichir" text="ðŸ”„ RafraÃ®chir" 
                onAction="#rafraichir"
                style="-fx-background-color: #7f8c8d; -fx-text-fill: white; -fx-font-weight: bold;
                       -fx-pref-height: 40px;"/>
        
        <Button fx:id="btnExporter" text="ðŸ“¥ Exporter" 
                onAction="#exporterLivres"
                style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold;
                       -fx-pref-height: 40px;"/>
    </HBox>
    
    <!-- ========== TABLEAU DES LIVRES ========== -->
    <VBox spacing="10" VBox.vgrow="ALWAYS">
        <Label text="ðŸ“‹ Liste des livres" style="-fx-font-weight: bold; -fx-font-size: 16px;"/>
        
        <TableView fx:id="tableViewLivres" VBox.vgrow="ALWAYS">
            <columns>
                <!-- Colonne ID -->
                <TableColumn fx:id="colId" text="ID" prefWidth="50">
                    <cellValueFactory>
                        <PropertyValueFactory property="id" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne Titre -->
                <TableColumn fx:id="colTitre" text="Titre" prefWidth="250">
                    <cellValueFactory>
                        <PropertyValueFactory property="titre" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne Auteur -->
                <TableColumn fx:id="colAuteur" text="Auteur" prefWidth="150">
                    <cellValueFactory>
                        <PropertyValueFactory property="auteur" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne ISBN -->
                <TableColumn fx:id="colIsbn" text="ISBN" prefWidth="120">
                    <cellValueFactory>
                        <PropertyValueFactory property="isbn" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne AnnÃ©e -->
                <TableColumn fx:id="colAnnee" text="AnnÃ©e" prefWidth="80">
                    <cellValueFactory>
                        <PropertyValueFactory property="datePublication" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne CatÃ©gorie -->
                <TableColumn fx:id="colCategorie" text="CatÃ©gorie" prefWidth="120">
                    <cellValueFactory>
                        <PropertyValueFactory property="categorie" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne QuantitÃ© Totale -->
                <TableColumn fx:id="colQuantiteTotal" text="Total" prefWidth="60">
                    <cellValueFactory>
                        <PropertyValueFactory property="quantiteTotale" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne Disponible -->
                <TableColumn fx:id="colQuantiteDispo" text="Dispo" prefWidth="60">
                    <cellValueFactory>
                        <PropertyValueFactory property="quantiteDisponible" />
                    </cellValueFactory>
                </TableColumn>
                
                <!-- Colonne Ã‰tat (calculÃ©) -->
                <TableColumn fx:id="colEtat" text="Ã‰tat" prefWidth="100">
                    <cellValueFactory>
                        <PropertyValueFactory property="disponible" />
                    </cellValueFactory>
                    <cellFactory>
                        <TableColumn fx:factory="call">
                            <Callback>
                                <TableCell>
                                    <Label fx:id="lblEtatCell">
                                        <graphic>
                                            <Region fx:id="iconRegion" style="-fx-background-color: gray; 
                                                                              -fx-min-width: 10; -fx-min-height: 10;
                                                                              -fx-max-width: 10; -fx-max-height: 10;
                                                                              -fx-background-radius: 5;"/>
                                        </graphic>
                                    </Label>
                                </TableCell>
                            </Callback>
                        </TableColumn>
                    </cellFactory>
                </TableColumn>
                
                <!-- Colonne Actions -->
                <TableColumn fx:id="colActions" text="Actions" prefWidth="150">
                    <cellFactory>
                        <TableColumn fx:factory="call">
                            <Callback>
                                <TableCell>
                                    <HBox spacing="5">
                                        <Button text="âœï¸" style="-fx-background-color: transparent; -fx-text-fill: #f39c12;"
                                                onAction="#modifierLivreFromCell"/>
                                        <Button text="ðŸ—‘ï¸" style="-fx-background-color: transparent; -fx-text-fill: #e74c3c;"
                                                onAction="#supprimerLivreFromCell"/>
                                        <Button text="ðŸ‘ï¸" style="-fx-background-color: transparent; -fx-text-fill: #3498db;"
                                                onAction="#voirDetailsFromCell"/>
                                    </HBox>
                                </TableCell>
                            </Callback>
                        </TableColumn>
                    </cellFactory>
                </TableColumn>
            </columns>
            
            <!-- Style du tableau -->
            <styleClass>
                <String fx:value="table-view" />
                <String fx:value="custom-table" />
            </styleClass>
        </TableView>
        
        <!-- Pagination -->
        <HBox spacing="10" alignment="CENTER_RIGHT">
            <Label text="Page :"/>
            <Button text="â—€ï¸ PrÃ©cÃ©dent" style="-fx-background-color: transparent;"/>
            <Label fx:id="lblPageCourante" text="1"/>
            <Label text="/"/>
            <Label fx:id="lblPagesTotales" text="1"/>
            <Button text="Suivant â–¶ï¸" style="-fx-background-color: transparent;"/>
            <Label text="Livres par page :"/>
            <ComboBox fx:id="cbItemsParPage" prefWidth="80">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value="10" />
                        <String fx:value="25" />
                        <String fx:value="50" />
                        <String fx:value="100" />
                    </FXCollections>
                </items>
                <value>
                    <String fx:value="25" />
                </value>
            </ComboBox>
        </HBox>
    </VBox>
    
    <!-- ========== PIED DE PAGE ========== -->
    <HBox spacing="20" alignment="CENTER" style="-fx-border-color: #ddd; -fx-border-width: 1 0 0 0; -fx-padding: 10 0 0 0;">
        <Label text="ðŸ’¡ Astuce : Double-cliquez sur une ligne pour modifier le livre"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Label fx:id="lblDerniereMiseAJour" text="DerniÃ¨re mise Ã  jour : --/--/---- --:--"/>
        <Label text="Â© BibliothÃ¨que - 2024"/>
    </HBox>
    
    <!-- ========== STYLES CSS ========== -->
    <stylesheets>
        <URL value="@/com/bibliotheque/view/css/livre.css" />
    </stylesheets>
    
</VBox>
